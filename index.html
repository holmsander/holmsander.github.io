<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Articles with View Counters</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .article-container {
            display: flex;
            align-items: center;
            margin: 10px;
            width: 100%;
            max-width: 600px;
        }
        .article-button {
            flex-grow: 1;
            padding: 12px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4361ee;
            color: white;
            border: none;
            border-radius: 4px;
            text-align: left;
            transition: background-color 0.3s;
        }
        .article-button:hover {
            background-color: #3a56d4;
        }
        .counter {
            margin: 0 10px;
            font-size: 16px;
            font-weight: bold;
            min-width: 40px;
            text-align: center;
        }
        .increment-button {
            padding: 8px 12px;
            font-size: 18px;
            cursor: pointer;
            background-color: #38b000;
            color: white;
            border: none;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .increment-button:hover {
            background-color: #2d8a00;
        }
        h1 {
            margin-bottom: 20px;
            color: #333;
        }
        .status {
            margin-top: 20px;
            padding: 10px;
            color: #666;
            font-style: italic;
        }
        .loading {
            color: #888;
        }
    </style>
</head>
<body>
    <h1>Articles</h1>
    
    <div class="article-container">
        <button class="article-button" onclick="location.href='https://holmsander.github.io/docs/chinese/x1.html'">暑假的奇怪事件</button>
        <div class="counter" id="counter-x1">-</div>
        <button class="increment-button" onclick="incrementCounter('x1')">+</button>
    </div>
    
    <div class="article-container">
        <button class="article-button" onclick="location.href='https://holmsander.github.io/docs/chinese/x2.html'">午夜的秘密</button>
        <div class="counter" id="counter-x2">-</div>
        <button class="increment-button" onclick="incrementCounter('x2')">+</button>
    </div>
    
    <div class="article-container">
        <button class="article-button" onclick="location.href='https://holmsander.github.io/docs/chinese/x3.html'">学语言这件事，心态比方法更重要？</button>
        <div class="counter" id="counter-x3">-</div>
        <button class="increment-button" onclick="incrementCounter('x3')">+</button>
    </div>
    
    <div class="article-container">
        <button class="article-button" onclick="location.href='https://holmsander.github.io/docs/chinese/x4.html'">气候变化：只是一个"形式"上的问题？</button>
        <div class="counter" id="counter-x4">-</div>
        <button class="increment-button" onclick="incrementCounter('x4')">+</button>
    </div>
    
    <div class="article-container">
        <button class="article-button" onclick="location.href='https://holmsander.github.io/docs/chinese/x5.html'">职场平等：现实还是理想</button>
        <div class="counter" id="counter-x5">-</div>
        <button class="increment-button" onclick="incrementCounter('x5')">+</button>
    </div>
    
    <div class="article-container">
        <button class="article-button" onclick="location.href='https://holmsander.github.io/docs/chinese/x6.html'">友谊与领导力</button>
        <div class="counter" id="counter-x6">-</div>
        <button class="increment-button" onclick="incrementCounter('x6')">+</button>
    </div>
    
    <div class="article-container">
        <button class="article-button" onclick="location.href='https://holmsander.github.io/docs/chinese/x7.html'">人生的节奏：该如何掌控自己的步伐？</button>
        <div class="counter" id="counter-x7">-</div>
        <button class="increment-button" onclick="incrementCounter('x7')">+</button>
    </div>

    <div class="article-container">
        <button class="article-button" onclick="location.href='https://holmsander.github.io/docs/chinese/x8.html'">追逐梦想的艰辛与美好</button>
        <div class="counter" id="counter-x8">-</div>
        <button class="increment-button" onclick="incrementCounter('x8')">+</button>
    </div>

    <div class="article-container">
        <button class="article-button" onclick="location.href='https://holmsander.github.io/docs/chinese/x9.html'">非洲草原上的奇妙之旅</button>
        <div class="counter" id="counter-x9">-</div>
        <button class="increment-button" onclick="incrementCounter('x9')">+</button>
    </div>

    <div class="article-container">
        <button class="article-button" onclick="location.href='https://holmsander.github.io/docs/chinese/x10.html'">生活中的小事</button>
        <div class="counter" id="counter-x10">-</div>
        <button class="increment-button" onclick="incrementCounter('x10')">+</button>
    </div>
    
    <div class="status" id="status"></div>

    <script>
        // API URL without trailing slash
        const API_URL = 'https://holmsandergithubio-production.up.railway.app';
        const statusElement = document.getElementById('status');
        
        // Array of article IDs
        const articleIds = ['x1', 'x2', 'x3', 'x4', 'x5', 'x6', 'x7', 'x8', 'x9', 'x10'];
        
        // Load all counters when page loads
        window.addEventListener('DOMContentLoaded', () => {
            loadAllCounters();
        });
        
        // Function to load all counters
        async function loadAllCounters() {
            try {
                const response = await fetch(`${API_URL}/counters`);
                if (!response.ok) {
                    throw new Error('Failed to fetch counters');
                }
                
                const data = await response.json();
                
                // Update counter displays
                articleIds.forEach(id => {
                    const counterElement = document.getElementById(`counter-${id}`);
                    const counterData = data.find(item => item.id === id);
                    
                    if (counterData) {
                        counterElement.textContent = counterData.value;
                    } else {
                        counterElement.textContent = '0';
                    }
                });
                
                statusElement.textContent = 'Counters loaded successfully';
                setTimeout(() => { statusElement.textContent = ''; }, 3000);
            } catch (error) {
                statusElement.textContent = `Error: ${error.message}`;
                console.error('Error loading counters:', error);
            }
        }
        
        // Function to increment a counter
        async function incrementCounter(id) {
            const passwordInput = prompt(`Please enter the password to increment counter for ${id}:`);
            
            if (!passwordInput) return;
            
            try {
                const response = await fetch(`${API_URL}/counter/increment`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 
                        id: id,
                        password: passwordInput 
                    })
                });
                
                if (response.status === 403) {
                    statusElement.textContent = "Incorrect password!";
                    return;
                }
                
                if (!response.ok) {
                    throw new Error('Failed to increment counter');
                }
                
                const data = await response.json();
                const counterElement = document.getElementById(`counter-${id}`);
                counterElement.textContent = data.value;
                
                statusElement.textContent = `Counter for ${id} incremented to ${data.value}!`;
                setTimeout(() => { statusElement.textContent = ''; }, 3000);
            } catch (error) {
                statusElement.textContent = `Error: ${error.message}`;
                console.error('Error incrementing counter:', error);
            }
        }
    </script>
</body>
</html>
